<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1" name="viewport" />
        <link href="style.css" rel="stylesheet" />
        <title>PDC非対応計算ツール</title>
        <link href="./manifest.json" rel="manifest" />
        <meta content="#0078d7" name="theme-color" />
        <link rel="apple-touch-startup-image" href="20250922.png" />
    </head>

    <body>
        <div class="notification-sync-bar">
            <div class="notification-icon" id="notificationIcon">
                <span class="notification-badge hidden" id="notificationBadge"></span>
            </div>
            <button id="external-links-button">🔗 外部ツールへ</button>
            <button id="syncButton">🔄 データ同期</button>
        </div>
        <div class="popup-wrapper hidden" id="notificationPopup">
            <div class="popup-overlay" id="popupOverlay"></div>
            <div class="popup-content">
                <h2>お知らせ</h2>
                <div id="notification-list"></div>
                <button id="popupCloseButton">閉じる</button>
            </div>
        </div>
        
        <div class="popup-wrapper hidden" id="links-popup">
            <div class="popup-overlay" id="links-popup-overlay"></div>
            <div class="popup-content">
                <h2>外部リンク</h2>
                <div id="external-links-list">
                    <h3>sanbon氏制作ツール</h3>
                    <ul>
                        <li><a href="https://sanbon.me/jp/resources/awoken" target="_blank" rel="noopener noreferrer">覚醒スキル</a></li>
                        <li><a href="https://sanbon.me/jp/resources/latent-awoken" target="_blank" rel="noopener noreferrer">潜在覚醒スキル</a></li>
                        <li><a href="https://sanbon.me/jp/resources/badge" target="_blank" rel="noopener noreferrer">バッジ</a></li>
                        <li><a href="https://sanbon.me/jp/resources/egg-simulator" target="_blank" rel="noopener noreferrer">ガチャシュミレーター</a></li>
                        <li><a href="https://sanbon.me/jp/resources/probability-simulator" target="_blank" rel="noopener noreferrer">ガチャ確率計算機</a></li>
                        <li><a href="https://sanbon.me/jp/resources/tier-maker" target="_blank" rel="noopener noreferrer">ティアメーカー</a></li>
                        <li><a href="https://sanbon.me/jp/resources/puzzle" target="_blank" rel="noopener noreferrer">パズル練習</a></li>
                    </ul>
                    <h3>Twitter(旧X)</h3>
                    <ul>
                        <li><a href="https://x.com/pad_sexy?t=JXqjclHA2FCRcVjGmvkPBQ&s=09" target="_blank" rel="noopener noreferrer">X - ムラコ</a></li>
                        <li><a href="https://x.com/DaikeYamamoto?t=HRze9R4A2QbOhrdvSE11qQ&s=09" target="_blank" rel="noopener noreferrer">X - ダイケ</a></li>
                        <li><a href="https://x.com/sarna_flanlily?t=nq1Ipbl-oH5u_IngR6WDRQ&s=09" target="_blank" rel="noopener noreferrer">X - 自作ツール製作者</a></li>
                    </ul>
                </div>
                <button id="links-popup-close-button">閉じる</button>
            </div>
        </div>

        <div class="container">
            <h1>PDC非対応計算ツール</h1>

            <div class="tabs">
                <button class="tab-button active" data-tab="damage">割合計算</button>
                <button class="tab-button" data-tab="exp">経験値計算</button>
                <button class="tab-button" data-tab="hp">HP計算</button>
            </div>

            <div class="tab-content hidden" id="hp">
                <div class="hp-section">
                    <h3 id="hp-section-1">1. パーティ合計HP計算</h3>
                    <div class="input-group hp-party-inputs">
                        <label>各キャラのHPを入力（6体分）</label>
                        <div>
                            <input type="number" min="0" id="hp1" placeholder="1体目 HP">
                            <input type="number" min="0" id="hp2" placeholder="2体目 HP">
                            <input type="number" min="0" id="hp3" placeholder="3体目 HP">
                            <input type="number" min="0" id="hp4" placeholder="4体目 HP">
                            <input type="number" min="0" id="hp5" placeholder="5体目 HP">
                            <input type="number" min="0" id="hp6" placeholder="6体目 HP">
                        </div>
                        <label>L(リーダー)HP倍率</label>
                        <input type="number" min="1" step="0.01" id="partyLHpMulti" placeholder="例: 2.6">
                        <label>F(フレンド)HP倍率</label>
                        <input type="number" min="1" step="0.01" id="partyFHpMulti" placeholder="例: 2.6">
                        <label>チームHP覚醒個数</label>
                        <input type="number" min="0" step="1" id="partyTeamHpAwakeCount" placeholder="例: 5">
                        <div class="hp-result" id="totalHpResult">-</div>
                    </div>
                </div>
                <div class="hp-section">
                    <h3 id="hp-section-2">2. チームHP覚醒で盛れているHP</h3>
                    <div class="input-group">
                        <label>合計HP</label>
                        <input type="number" min="0" id="teamTotalHp" placeholder="合計HP">
                        <label>チームHP覚醒の個数</label>
                        <input type="number" min="0" id="teamHpAwakeCount" placeholder="チームHP覚醒個数">
                        <div class="hp-result" id="teamHpAwakeResult">-</div>
                    </div>
                </div>
                <div class="hp-section">
                    <h3 id="hp-section-3">3. 実質HP計算</h3>
                    <div class="input-group">
                        <strong>L（リーダー）</strong><br>
                        <label>HP倍率</label>
                        <input type="number" min="1" step="0.01" id="actualLHpMulti" placeholder="例: 2.6">
                        <label>軽減率（0〜1）</label>
                        <input type="number" min="0" max="1" step="0.01" id="actualLReduce" placeholder="例: 0.5 (50%軽減)">
                        <div class="hp-result" id="actualLHpResult">-</div>
                        <hr>
                        <strong>F（フレンド）</strong><br>
                        <label>HP倍率</label>
                        <input type="number" min="1" step="0.01" id="actualFHpMulti" placeholder="例: 2.6">
                        <label>軽減率（0〜1）</label>
                        <input type="number" min="0" max="1" step="0.01" id="actualFReduce" placeholder="例: 0.3 (30%軽減)">
                        <div class="hp-result" id="actualFHpResult">-</div>
                        <hr>
                        <label>軽減スキル（0〜1）</label>
                        <input type="number" min="0" max="1" step="0.01" id="actualSkillReduce" placeholder="例: 0.75 (75%軽減)">
                        <div class="hp-result" id="actualHpResult">-</div>
                        <div class="hp-result" id="actualHpRateResult">-</div>
                    </div>
                </div>
                <div class="hp-section">
                    <h3 id="hp-section-4">4. チームHP覚醒個数逆算</h3>
                    <div class="input-group">
                        <label>目標HP</label>
                        <input type="number" min="0" id="targetHp" placeholder="目標HP">
                        <label>現状HP</label>
                        <input type="number" min="0" id="currentHp" placeholder="現状HP">
                        <div class="hp-result" id="neededAwakeResult">-</div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="damage">
                <div class="input-group">
                    <label for="dungeonSelect">ダンジョン選択:</label>
                    <select id="dungeonSelect"></select>
                </div>
                <div class="input-group">
                    <label for="floorSelect">フロア選択:</label>
                    <select id="floorSelect"></select>
                </div>
                <div class="input-group">
                    <label for="inputA">リーダー軽減率 (A) 例: 50%軽減→0.5 , 20%軽減→0.2</label>
                    <input id="inputA" max="1" min="0" step="0.01" type="number" value="0" />
                </div>
                <div class="input-group">
                    <label for="inputB">助っ人軽減率 (B) 例: 50%軽減→0.5 , 20%軽減→0.2</label>
                    <input id="inputB" max="1" min="0" step="0.01" type="number" value="0" />
                </div>
                <div class="input-group">
                    <label for="inputC">軽減スキル (C)</label>
                    <select id="inputC">
                        <option value="0">0%</option>
                        <option value="0.05">5%</option>
                        <option value="0.1">10%</option>
                        <option value="0.15">15%</option>
                        <option value="0.2">20%</option>
                        <option value="0.25">25%</option>
                        <option value="0.3">30%</option>
                        <option value="0.35">35%</option>
                        <option value="0.4">40%</option>
                        <option value="0.45">45%</option>
                        <option value="0.5">50%</option>
                        <option value="0.6">60%</option>
                        <option value="0.65">65%</option>
                        <option value="0.7">70%</option>
                        <option value="0.75">75%</option>
                        <option value="0.8">80%</option>
                        <option value="0.85">85%</option>
                        <option value="0.9">90%</option>
                    <option value="1">100% (完全無効)</option>
                </select>
                </div>
                <div class="input-group">
                    <label for="inputL">回復L字消し個数 (1個5%軽減)</label>
                    <input id="inputL" min="0" step="1" type="number" value="0" />
                </div>
                <div id="results">
                    <h2>計算結果</h2>
                    <p id="totalReductionRate"></p>
                    <table class="results-table" id="resultsTable">
                        <thead>
                            <tr>
                                <th>フロアの割合ダメージ</th>
                                <th>最終的なHPに対するダメージ割合</th>
                                <th>耐えれるか</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="tab-content hidden" id="exp">
                <div class="input-group">
                    <label for="expDungeon">ダンジョン選択:</label>
                    <select id="expDungeon"></select>
                </div>
                <div class="input-group">
                    <label for="expFloor">フロア選択:</label>
                    <select disabled="" id="expFloor"></select>
                </div>
                <div class="input-group">
                    <label for="leaderMultiplier">リーダー経験値倍率:</label>
                    <select id="leaderMultiplier">
                        <option value="1.0">1.0倍</option>
                        <option value="1.1">1.1倍</option>
                        <option value="1.2">1.2倍</option>
                        <option value="1.3">1.3倍</option>
                        <option value="1.4">1.4倍</option>
                        <option value="1.5">1.5倍</option>
                        <option value="1.6">1.6倍</option>
                        <option value="1.7">1.7倍</option>
                        <option value="1.8">1.8倍</option>
                        <option value="1.9">1.9倍</option>
                        <option value="2.0">2.0倍</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="friendMultiplier">助っ人経験値倍率:</label>
                    <select id="friendMultiplier">
                        <option value="1.0">1.0倍</option>
                        <option value="1.1">1.1倍</option>
                        <option value="1.2">1.2倍</option>
                        <option value="1.3">1.3倍</option>
                        <option value="1.4">1.4倍</option>
                        <option value="1.5">1.5倍</option>
                        <option value="1.6">1.6倍</option>
                        <option value="1.7">1.7倍</option>
                        <option value="1.8">1.8倍</option>
                        <option value="1.9">1.9倍</option>
                        <option value="2.0">2.0倍</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="dungeonBonusCount">ダンジョンボーナス覚醒数:</label>
                    <input id="dungeonBonusCount" min="0" step="1" type="number" value="0" />
                    <small>1つにつき2%加算され、累乗されます</small>
                </div>
                <div class="input-group">
                    <label for="padPassBonus">パズパスボーナス</label>
                    <select id="padPassBonus">
                        <option value="1">なし</option>
                        <option value="1.05">5%UP</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="adDouble">広告視聴2倍</label>
                    <select id="adDouble">
                        <option value="1">なし</option>
                        <option value="2">2倍</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="badgeBonus">バッジ効果</label>
                    <select id="badgeBonus">
                        <option value="1">なし</option>
                        <option value="1.1">10%UP</option>
                    </select>
                </div>
                <div id="expResult">
                    <h2>経験値結果</h2>
                    <p id="expValue">-</p>
                </div>
            </div>
        </div>

        <script src="script.js" defer></script>
    </body>
</html>
